<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>scribe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    @font-face {
      font-family: 'OfficeTimes';
      src: url('OfficeTimesRound-RoundMono.otf') format('opentype');
    }

    @font-face {
      font-family: 'Social';
      src: url('ABCSocialCyrillic-Regular-Trial.woff') format('woff');
    }

    @font-face {
      font-family: 'Diatype';
      src: url('ABCDiatypeMonoVariable-Trial.woff') format('woff');
    }

    body {
      font-family: 'Diatype', serif;
      font-size: 13px;
      margin: 0;
      line-height: 1.6;
      font-weight: 350;
      color: #fffaee;
      background-color: black;
    }

    /* --- Layout --- */
    .layout {
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      justify-content: center;
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
      box-sizing: border-box;
    }

    .About {
      width: 300px;
      flex-shrink: 0;
      padding: 10px;
      position: sticky;
      top: 2rem;
      align-self: flex-start;
      height: fit-content;
    }

    .main-content {
      flex: 1;
      max-width: 700px;
    }

    /* --- Scrollable prompt feed --- */
    #prompts {
      overflow-y: auto;
      padding: 1rem 2rem;
      margin: 1rem 0;
      width: 100%;
      box-sizing: border-box;
      height: 60vh;
      min-height: 300px;
      border-top: 1px solid rgba(0,0,0,0.1);
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .prompt-entry {
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      font-family: 'Diatype', serif;
      font-size: 13px;
    }

    .prompt-entry small {
      display: block;
      font-size: 13px;
      text-transform: lowercase;
      color: #8C8983;  /* updated color */
      font-weight: 350;
      font-family: 'Diatype', serif;
      margin-bottom: 0.25rem;
    }

    /* Style for names */
    .prompt-name {
      font-weight: 400; /* normal weight */
      display: inline;  /* stay inline with response */
      margin-right: 0.25rem;
      color: #fffaee;
    }

    /* --- Form styling --- */
    form {
      max-width: 700px;
      width: 100%;
      margin: 0 auto;
      padding: 2rem 2rem 2rem;
      box-sizing: border-box;
      font-family: 'Diatype', serif;
      font-size: 13px;
    }

    form label {
      display: block;
      margin-bottom: 1rem;
    }

    /* Add spacing between input groups */
    form label + label {
      margin-top: 1.5rem;
    }

    input, textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 0.75rem;
      margin-top: 0.25rem;
      border: 1px solid #191919;
      border-radius: 2px;
      font-family: 'Diatype', serif;
      color: #75736E;
      font-size: 13px;
      background-color: black;
      resize: vertical;
    }

    button {
      padding: 0.6rem 1.2rem;
      background: black;
      color: #fffaee;
      font-family: 'Diatype', serif;
      font-size: 13px;
      border-radius: 50px;
      cursor: pointer;
      margin-top: 1.5rem;
    }
    button:hover { opacity: 0.5; }

    /* --- Mobile view --- */
    @media(max-width: 800px) {
      .layout { flex-direction: column; }
      .About {
        position: static;
        width: 100%;
        padding: 1rem 0;
      }
      header, p, h1, form, #prompts { padding: 0 1rem; }
    }
  </style>
</head>
<body>

  <div class="layout">
    <!-- About section -->
    <div class="About">
      <p>⬤ scribe is a literary platform in early development, intended as a curated, quieter space for meditating upon queer identity and the complex emotions that can often accompany it.</p> 
      <br>
      <p>each prompt draws from the work of queer thinkers, writers, essayists, and artists, presenting their core principles and valuable insights as starting points for reflection. should this speak to u, perhaps try a little scribe.</p>
      <br>
      <p>this prompt invites u to reflect on the parts of urself that remain hidden and whether they now long to be seen.</p>
    </div>

    <!-- Prompts + form -->
    <div class="main-content">
      <section id="prompts"></section>

      <section>
        <form id="prompt-form">
          <label>
            alias
            <input type="text" name="name" placeholder="ama, audre, u" required>
          </label>

          <label>
            location
            <input type="text" name="location" placeholder="london, moon, stars" required>
          </label>

          <label>
            ur love and how they make you feel
            <textarea name="response" placeholder="reveal, or don't" required></textarea>
          </label>

          <button type="submit">submit</button>
        </form>
      </section>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBp2QOnTd_0PtX1PCivKLozg9vGIz5OLzQ",
      authDomain: "scribe-61849.firebaseapp.com",
      projectId: "scribe-61849",
      storageBucket: "scribe-61849.appspot.com",
      messagingSenderId: "209905470454",
      appId: "1:209905470454:web:118eceef8d217556cdd5d7"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const form = document.getElementById('prompt-form');
    const prompts = document.getElementById('prompts');

    function formatDate(date) {
      const options = { month: '2-digit', day: '2-digit' };
      const datePart = date.toLocaleDateString('en-US', options).replace(/\//g, '.');
      const timePart = date.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
      return `${datePart} · ${timePart}`;
    }

    form.addEventListener('submit', async e => {
      e.preventDefault();
      const name = form.name.value.trim();
      const location = form.location.value.trim();
      const response = form.response.value.trim();

      if (!name || !location || !response) {
        alert("Please fill out all fields.");
        return;
      }

      await db.collection('prompts').add({
        name,
        location,
        response,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      });

      form.reset();
    });

    db.collection('prompts')
      .orderBy('timestamp', 'desc')
      .onSnapshot(snapshot => {
        prompts.innerHTML = '';
        if (snapshot.empty) {
          prompts.innerHTML = '<p style="opacity:0.5;font-family:sans-serif;">No entries yet.</p>';
          return;
        }
        snapshot.forEach(doc => {
          const data = doc.data();
          const div = document.createElement('div');
          div.className = 'prompt-entry';
          const date = data.timestamp ? data.timestamp.toDate() : new Date();
          div.innerHTML = `
            <small>${formatDate(date)} · ${data.location}</small>
            <p><span class="prompt-name">${data.name}:</span> ${data.response}</p>
          `;
          prompts.appendChild(div);
        });
        prompts.scrollTo({ top: 0, behavior: 'smooth' });
      });
  </script>
</body>
</html>
