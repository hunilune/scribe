<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>scribe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    /* === Fonts === */
    @font-face {
      font-family: 'OfficeTimes';
      src: url('OfficeTimesRound-RoundMono.otf') format('opentype');
    }
    @font-face {
      font-family: 'Social';
      src: url('ABCSocialCyrillic-Regular-Trial.woff') format('woff');
    }
    @font-face {
      font-family: 'Diatype';
      src: url('ABCDiatypeMonoVariable-Trial.woff') format('woff');
    }

    /* === Base === */
    body {
      font-family: 'Diatype', serif;
      font-size: 16px;
      margin: 0;
      line-height: 1.6;
      color: black;
      background-color: white;
    }

    /* === Layout === */
    .layout {
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      justify-content: center;
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto;
      height: 100vh; /* full viewport height */
      padding: 2rem;
      box-sizing: border-box;
      overflow: hidden; /* contain scroll */
    }

    /* === About Column === */
    .About {
      width: 300px;
      flex-shrink: 0;
      padding: 10px;
      position: sticky;
      top: 2rem;
      align-self: flex-start;
      height: fit-content;
      font-family: 'Diatype', serif;
      font-size: 0.95rem;
    }

    /* === Main Content === */
    .main-content {
      flex: 1;
      max-width: 700px;
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
    }

    /* === Prompts Feed === */
    #prompts {
      flex: 1;
      overflow-y: auto;
      padding: 1rem 2rem;
      margin: 1rem 0;
      width: 100%;
      box-sizing: border-box;
      border-top: 1px solid rgba(0, 0, 0, 0.05);
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      scroll-behavior: smooth;
    }

    .prompt-entry {
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      font-family: 'Social', serif;
      font-size: 0.9rem;
      opacity: 0;
      animation: fadeIn 0.6s ease forwards;
    }

    .prompt-entry small {
      display: block;
      font-size: 0.85rem;
      text-transform: lowercase;
      color: #A9A9A9;
      font-family: 'Diatype', serif;
      margin-bottom: 0.25rem;
    }

    /* === Form === */
    form {
      max-width: 700px;
      width: 100%;
      margin: 0 auto;
      padding: 2rem 2rem 2rem;
      box-sizing: border-box;
      font-family: 'Social', serif;
      font-size: 0.85rem;
    }

    label {
      display: block;
      margin-bottom: 1rem;
      font-weight: bold;
    }

    input, textarea {
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
      padding: 0.75rem;
      margin-top: 0.25rem;
      border: 1px solid #adadad;
      border-radius: 2px;
      font-family: 'Social', serif;
      font-size: 0.85rem;
      background-color: white;
      resize: vertical;
    }

    button {
      padding: 0.6rem 1.2rem;
      background: black;
      color: white;
      font-family: 'Social', serif;
      font-size: 0.8rem;
      border-color: white;
      border-radius: 50px;
      cursor: pointer;
      transition: opacity 0.2s ease;
    }
    button:hover { opacity: 0.5; }

    /* === Animation === */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* === Mobile === */
    @media(max-width: 800px) {
      .layout {
        flex-direction: column;
        height: auto;
        overflow: visible;
      }

      .About {
        position: static;
        width: 100%;
        padding: 1rem 0;
      }

      .main-content {
        height: auto;
      }

      #prompts {
        max-height: none;
        overflow: visible;
      }
    }
  </style>
</head>

<body>
  <div class="layout">
    <!-- About Section -->
    <div class="About">
      <p>Scribe is a literary platform in early development, intended as a curated, quieter space for meditating upon queer identity and the complex emotions that can often accompany it.</p> 
      <br>
      <p>Each prompt draws from the work of queer thinkers, writers, essayists, and artists, presenting their core principles and valuable insights as starting points for reflection. If this speaks to you, perhaps try a little Scribe.</p>
      <br>
      <p>September’s prompt invites you to reflect on the parts of yourself that remain hidden and whether they now long to be seen.</p>
    </div>

    <!-- Prompts + Form -->
    <div class="main-content">
      <section id="prompts"></section>

      <section>
        <form id="prompt-form">
          <label>
            <strong>Name</strong>
            <input type="text" name="name" placeholder="Audre, Rita, You" required>
          </label>
          <label>
            <strong>Location</strong>
            <input type="text" name="location" placeholder="London, Bedroom, Moon" required>
          </label>
          <label>
            <strong>Your love and how they make you feel</strong>
            <textarea name="response" placeholder="Reveal, or don't" required></textarea>
          </label>
          <button type="submit">Submit</button>
        </form>
      </section>
    </div>
  </div>

  <!-- === Firebase === -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBp2QOnTd_0PtX1PCivKLozg9vGIz5OLzQ",
      authDomain: "scribe-61849.firebaseapp.com",
      projectId: "scribe-61849",
      storageBucket: "scribe-61849.appspot.com",
      messagingSenderId: "209905470454",
      appId: "1:209905470454:web:118eceef8d217556cdd5d7"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const form = document.getElementById('prompt-form');
    const prompts = document.getElementById('prompts');

    function formatDate(date) {
      const options = { month: '2-digit', day: '2-digit' };
      const datePart = date.toLocaleDateString('en-US', options).replace(/\//g, '.');
      const timePart = date.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
      return `${datePart} · ${timePart}`;
    }

    form.addEventListener('submit', async e => {
      e.preventDefault();
      const name = form.name.value.trim();
      const location = form.location.value.trim();
      const response = form.response.value.trim();

      if (!name || !location || !response) {
        alert("Please fill out all fields.");
        return;
      }

      await db.collection('prompts').add({
        name,
        location,
        response,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      });

      form.reset();
    });

    db.collection('prompts')
      .orderBy('timestamp', 'desc')
      .onSnapshot(snapshot => {
        prompts.innerHTML = '';
        snapshot.forEach(doc => {
          const data = doc.data();
          const div = document.createElement('div');
          div.className = 'prompt-entry';
          const date = data.timestamp ? data.timestamp.toDate() : new Date();
          div.innerHTML = `
            <small>${formatDate(date)} · ${data.location}</small>
            <p><strong>${data.name}:</strong> ${data.response}</p>
          `;
          prompts.appendChild(div);
        });

        // Smooth auto-scroll to top
        prompts.scrollTo({ top: 0, behavior: 'smooth' });
      });
  </script>
</body>
</html>
